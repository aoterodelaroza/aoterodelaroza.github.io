---
layout: single
title: "Reference Manual"
permalink: /critic2/manual/
excerpt: "The critic2 reference manual."
sidebar:
  nav: "critic2_manual"
categories: critic2 manual
toc: true
toc_label: "External Libraries"
toc_sticky: false
classes: wide
---

## Overview

Critic2 is a program for the analysis and representation of electron
densities and other scalar fields in solids and molecules. It is able
to read the output generated by multiple solid-state and molecular
electronic structure programs, and to analyze, manipulate and
interconvert structures and scalar fields.

The original intent of critic2 was to analyze electron densities using
Bader's Quantum Theory of Atoms in Molecules (QTAIM). Some of
critic2's basic operations, for instance, are finding the critical
points of a scalar field (Bader's topology), or to find the attraction
basins of the maxima and integrate quantities in them (Bader's atomic
charges). In recent versions, however, critic2 has been extended to
support closely-related operations, such as manipulating and
interconverting structural formats, perform arithmetic operations on
scalar fields, calculate related quantities like STM images, calculate
NCI plots, and many, many more.

Within the QTAIM framework, critic2 also provides a host of
specialized algorithms: four different atomic basin integration
methods as well as a powerful and flexible automatic critical point
searching technique. Many scalar fields other than the electron
density are amenable to a QTAIM-style analysis (finding the topology
and integrating the attractor basins). These techniques (called
Quantum Chemical Topology, QCT, by P. Popelier) can be applied to a
variety of scalar fields including the ELF and the Laplacian of the
electron density. Critic2 can perform all these tasks for any field
either provided by the user or calculated inside the program.

A characteristic feature of critic2 is that it encapsulates common
operations and applies them, regardless of the electron density
source. If, for instance, one wants to calculate the critical points
of an electron density, the similar inputs and outputs are used and
obtained, regardless of whether the density comes from a gas-phase
calculation, a plane-wave code, or is described in terms of augmented
plane waves.

Critic2 was originally a program that only worked with electron
densities for periodic crystals. Support for molecular structures and
wavefunctions is quite good, but not as good as for crystals. In
particular, be aware that critic2 treats all systems---both crystals
and molecules---as if they were periodically repeated. The only
difference is that molecules are placed inside a very large repetition
cell. In principle, this is not a problem, but oddities and bugs may
be lurking.

Critic2 is described in Comput. Phys. Commun. 180 (2009), 157-166 and
Comput. Phys. Commun. 185 (2014), 1007-1018. Please, cite these
references if you find this program useful. The file THANKS contains a
complete list of contributors and other programs from where parts of
critic2 have been adapted.

## Installation

Please, see the README file. Particularly, note that the development
version of critic2 uses fairly modern Fortran, and you may need a
relatively recent Fortran compiler to use it.

## Command-line options, usage, and input overview

Critic2 accepts a single input file (usually but not necessarily
with extension .cri). The command-line syntax is:
~~~
$ critic2 [-q] [-h] [-r /path/to/critic2] ...
          [file.cri [file.cro]]
~~~
If both input and output files are present, the output is redirected
to file.cro. Otherwise, it is written to standard output. If no
file.cri is present, the input is taken from standard input. The input
and output extensions (cri and cro) are not mandatory. This is also
valid:
~~~
$ critic2 < file.cri > file.cro
~~~
Alternatively, you can use the standard input and standard output:
~~~
$ critic2
~~~
and then enter the commands by hand. In addition, depending on the
tasks in the input file, auxiliary files may be generated, usually
with the same root as file.cri ("file", in the example above) or
"stdin" if no input file is given.

The -h option ("help") prints a short help message and exits. The -q
option ("quiet") inhibits the initial and final messages. This is
useful when using critic2 in a pipe command. In addition, If no -q is
passed, a copy of each input line read by critic2 is written to the
output, preceded by a "%%" prefix. This helps identify the different
parts of the output. The -r option tells critic2 where to find its
data files. If /path/to/critic2 is given, the data files (wfc, dic,
etc.) should be in /path/to/critic2/dat.

The input file usually contains a specification of the crystal or
molecular structure using the CRYSTAL (see `The crystal structure`_)
or the MOLECULE (see `The molecular structure`_) keywords. For
instance:
~~~
CRYSTAL file.struct
~~~
After the structure is read, one or more fields are loaded using the
keyword LOAD. For instance:
~~~
LOAD file.clmsum file.struct
~~~
Unless otherwise stated, the default distance units in critic2, both
in input and output, are atomic units (bohr) for crystals and angstrom
for molecules. This can be changed using the UNITS keyword (see `Input
and output units`_). Electron densities are always in atomic units
(electrons/bohr^3).

After reading the structure and loading the relevant fields, specific
keywords are used to perform the required tasks. For instance, AUTO
(automatic determination of critical points), INTEGRALS (atomic
integration), NCIPLOT (non-covalent interaction index plots), etc.  A
concise description of the critic2 keyword syntax is given in the
syntax.txt file. If you are already familiar with this program, that
file will probably be more useful to you than this guide.

### Example set

You can find a collection of examples that demonstrate the usage and
features of critic2 in the examples/ subdirectory. The examples.txt
contains the whole list and a brief description of every example. The
input files mentioned contain more details inside.

xxxxxxxx

## Usual CRYSTAL/LOAD and MOLECULE/LOAD combinations

* **WIEN2k**

~~~
CRYSTAL name.struct
LOAD name.clmsum name.struct
~~~

* **Quantum ESPRESSO**

~~~
CRYSTAL name.cube
LOAD name.cube

CRYSTAL name.scf.out
LOAD name.cube

CRYSTAL
  CARTESIAN celldm(1)
    ... CELL_PARAMETERS matrix ...
  ENDCARTESIAN
  NEQ x0 y0 z0 C 
  ... rest of the ATOMIC_POSITIONS list ...
ENDCRYSTAL
LOAD name.cube

CRYSTAL name.scf.in
LOAD name.cube
~~~

* **Abinit**

~~~
CRYSTAL name_DEN
LOAD name_DEN
~~~

* **VASP CHGCAR format (divided by cell volume)**

~~~
CRYSTAL POSCAR POTCAR
LOAD CHGCAR ZPSP C 4 H 4

CRYSTAL POSCAR POTCAR
LOAD AECCAR0
LOAD AECCAR2
LOAD AS "$1+$2"
REFERENCE 3

CRYSTAL POSCAR POTCAR
LOAD CHG
LOAD ELFCAR
~~~

* **elk**

~~~
CRYSTAL GEOMETRY.OUT
LOAD STATE.OUT GEOMETRY.OUT
~~~

* **aiPI**

~~~
CRYSTAL
  CELL a b c alpha beta gamma
  SPG 'space group'
  NEQ x y z atom
  ...
ENDCRYSTAL
LOAD at1.ion at1 at2.ion at2 ...
~~~

* **DFTB+ crystal**

~~~
CRYSTAL crystal.gen
LOAD detailed.xml eigenvec.bin wfc.hsd
~~~

* **DFTB+ molecule**

~~~
MOLECULE mol.gen
LOAD detailed.xml eigenvec.bin wfc.hsd
~~~

* **Any code that writes Gaussian cubes**

~~~
CRYSTAL name.cube
LOAD name.cube
~~~

* **Gaussian molecules**

~~~
MOLECULE name.wfn
LOAD name.wfn

MOLECULE name.wfx
LOAD name.wfx

MOLECULE name.fchk
LOAD name.fchk
~~~

* **MOLDEN-style files**

~~~
MOLECULE name.molden
LOAD name.molden
~~~

* **Promolecular/procrystal density calculations**

~~~
CRYSTAL name.cif

MOLECULE name.xyz
~~~

* **Conversion between crystal formats**

~~~
CRYSTAL name.cif
WRITE name.scf.in
WRITE name.xyz MOLMOTIF
~~~

* **Conversion between grid formats**

~~~
CRYSTAL name.cif
LOAD rhoup_DEN
LOAD rhodn_DEN
LOAD AS '$1-$2' n1 n2 n3
CUBE GRID FILE rhospin.cube FIELD 3
~~~
