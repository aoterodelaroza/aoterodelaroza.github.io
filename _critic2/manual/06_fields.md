---
layout: single
title: "Loading scalar fields"
permalink: /critic2/manual/fields/
excerpt: "Load scalar fields in critic2."
sidebar:
  nav: "critic2_manual"
categories: critic2 manual fields
toc: true
toc_label: "Loading scalar fields"
toc_sticky: true
---

## Loading a field (LOAD) {#c2-load}

Scalar fields are loaded with the LOAD keyword. A number of different
field formats are supported:
~~~
LOAD file.cube
LOAD file.bincube
LOAD file_{DEN|PAWDEN|ELF|ELF|POT|VHA|VHXC|VXC|GDEN1|
           GDEN2|GDEN3|LDEN|KDEN}
LOAD [file.]{CHGCAR|AECCAR0|AECCAR2}
LOAD {[file.]CHG|[file.]ELFCAR}
LOAD file.qub
LOAD file.xsf
LOAD file.grid
LOAD file.clmsum file.struct
LOAD file.{RHO,BADER,DRHO,LDOS,VT,VH}
LOAD file.OUT
LOAD STATE.OUT GEOMETRY.OUT
LOAD STATE.OUT GEOMETRY.OUT OTHER.OUT
LOAD file1.ion {nat1.i/at1.s} file2.ion ...
LOAD file.xml file.bin file.hsd
LOAD file.wfn
LOAD file.wfx
LOAD file.fchk [READVIRTUAL]
LOAD file.molden [READVIRTUAL]
LOAD file.pwc [file.chk [filedn.chk]]
LOAD COPY id.s [TO id2.s]
LOAD PROMOLECULAR
LOAD PROMOLECULAR [FRAGMENT file.xyz]
LOAD [WIEN|ELK|PI|CUBE|ABINIT|VASP|VASPCHG|QUB|XSF|ELKGRID|SIESTA|DFTB|
      WFN|WFX|MOLDEN|FCHK|PWC] file
LOAD ... [NEAREST|TRILINEAR|TRISPLINE|TRICUBIC] [EXACT|APPROXIMATE]
         [RHONORM|VNORM] [CORE|NOCORE] [NUMERICAL|ANALYTICAL]
         [TYPNUC {-3,-1,1,3}] [NORMALIZE n.r] [{NAME|ID} id.s]
         [NOTESTMT] [ZPSP at1.s q1.r...]
LOAD AS "expression.s" [n1.i n2.i n3.i|SIZEOF id.s|GHOST]
LOAD AS PROMOLECULAR {n1.i n2.i n3.i|SIZEOF id.s} 
        [FRAGMENT file.xyz]
LOAD AS CORE {n1.i n2.i n3.i|SIZEOF id.s}
LOAD AS LAP id.s
LOAD AS GRAD id.s
LOAD AS POT id.s [RY|RYDBERG]
LOAD AS CLM {ADD id1.s id2.s|SUB id1.s id2.s}
~~~
Critic2 loads scalar fields in "field slots": integer identifiers that
represent the field throughout the run. The NAME (or ID) keyword can
be used to assign a string identifier to a field as well. At the
beginning of the run, slot number 0 is occupied by the promolecular
density, which is automatically loaded right after the structure is
succesfully read. Successive LOAD commands fill the slots in
increasing order: the first LOAD will assign the new field to slot 1,
the second LOAD will occupy slot 2, and so on. By default, the first
loaded field (other than the promolecular density in slot 0) becomes
the reference field (see `The reference field (REFERENCE)`_).

The simplest usage of load is:
~~~
LOAD file.ext
~~~
The field information is read from file.ext. Critic2 uses the
extension to decide which format should be used for the reading:

* cube for Gaussian cube files (grid). Cube files can also be
  generated by programs other than Gaussian, for instance, Quantum
  ESPRESSO. They may correspond to a molecule or a periodic crysatl.

* Binary cube files (bincube) contain the same information as cube
  files but use a binary format. They can be generated by critic2.

* _DEN, _PAWDEN, _ELF,... for abinit grids.

* CHGCAR, AECCAR0, AECCAR2, CHG, or ELFCAR for VASP grids.

* qub for aimpac grids.

* xsf for xcrysden grids.

* grid for elk's grids (this requires a patch to elk, e-mail to
  request it).

* clmsum for WIEN2k.

* RHO, BADER, DRHO, LDOS, VT, and VH for SIESTA's grids.

* OUT for elk's STATE.OUT, ELF3D.OUT, RHO3D.OUT, etc.

* ion for aiPI ion files.

* xml for DFTB+'s detailed.xml.

* wfn, wfx, and fchk for Gaussian wavefunction files.

* molden for molecular wavefunction files (molden-style format). Both
  STO and GTO molecular wavefunctions are supported.

* pwc for the electron density plus Kohn-Sham state information from
  Quantum ESPRESSO, generated using the pw2critic.x program in
  PP/. Optionally, one or two checkpoint files from wannier90.

Specific details about each of these field types are given in the
following sections.

In some cases, the extension of the file to be loaded may be different
from the one that critic2 expects. For instance, WIEN2k creates files
with extensions other than clmsum for different fields (e.g. clmup for
the spin-up density) but the same format. In those cases, the keywords
WIEN/ELK/... can be used to force critic2 to read in a specific
format.

### Cube files (cube, bincube)

Cube files can be generated by Gaussian's cubegen utility, but also by
other programs such as Quantum ESPRESSO. If the cube file corresponds
to a crystal structure, it is possible that it contains a
non-orthogonal grid (despite its name). Binary cube files (bincube)
are created by critic2.

### Abinit density grids (DEN)

Density files generated by abinit come in a binary DEN format
(file_DEN or file_PAWDEN) and can be loaded by simply passing them to
LOAD. These files contain a grid of field values. Alternatively, other
files can be written using the "prt*" options in abinit, containing
different scalar fields in the same format, including the electron
localization function (prtelf, _ELF suffix), the Laplacian of the
electron density (prtlden, _LDEN), the exchange-correlation potentiatl
(prtvxc, _VXC), the kinetic energy density (usekden, prtkden, _KDEN),
the Hartree potential (prtvha, _VHA), the Hartree plus xc potential
(prtvhxc, _VHXC), and the total potential (prtpot, _POT).

### VASP files (CHGCAR, AECCAR0, AECCAR2, CHG, ELFCAR)

VASP fields can come in two varieties. The CHGCAR and AECCAR* files
give the grid values in a higher precision and multiplied by the cell
volume. The CHGCAR can be read directly with LOAD and the AECCAR can
be read with something like:
~~~
LOAD VASP AECCAR0
~~~
The other format is the CHG, that is also used for the ELFCAR
(containing the values of the ELF function). In this case, the grid
values are given with less precision and they may or may not be
multiplied by the cell volume (depending on the VASP version). Both
can be loaded with:
~~~
LOAD CHG
LOAD ELFCAR
~~~
But if you have a file in this format that does not conform to those
names, you can use the VASPCHG keyword:
~~~
LOAD VASPCHG STRANGE_CHG_FILE_NAME.chg
~~~
The CHGCAR files are relatively safe to use, but CHGs data points may
or may not be multiplied by the unit cell volume, and you have to tell
critic2 which one it is. If you have a CHG file that is multiplied by
the volume, then you can force critic2 to load it in the same way as a
CHGCAR with:
~~~
LOAD VASP CHG
~~~
I have never seen an ELFCAR that is multiplied by the volume (it would
not make much sense anyway), so the default behavior for ELFCAR files
is to assume that it is not.

### QE wavefunction plus Wannier checkpoint files (pwc)

The pwc file format is generated by the pw2critic utility in the
post-processing (PP) package of Quantum ESPRESSO. The pwc file
contains the crystal structure, k-point and plane-wave information,
the Kohn-Sham state coefficients, as well as the various mappings
necessary to use them. A field loaded using a pwc file corresponds to
the pseudo-valence density of the calculation, but the individual
Kohn-Sham states are read as well, which allows additional
calculations in critic2.

In particular, the LOAD command for the pwc file can be supplemented
with a second file (with extension chk) generated by Wannier90 during
the calculation of the maximally localized Wannier functions of the
system. A field loaded in this way can be used in the calculation of
delocalization indices in periodic systems. See
http://dx.doi.org/10.1021/acs.jctc.8b00549 and 
`Integrating delocalization indices in a solid with maximally localized Wannier functions`_
for more information. An additional file also generated by wannier90
is necessary to provide the MLWF orbital rotations in spin-polarized
systems. In that case, the first checkpoint file comes from the
up-spin wannier90 calculation and the second checkpoint file from the
down-spin wannier90 calculation. See the FeO case in the dis_wannier
example.

### WIEN2k (clmsum, etc.)

In the case of WIEN2k, not all the necessary information is
encapsulated in the clmsum (for instance, the muffin tin radii are
missing), so it is necessary to provide a second file: the struct
file. This is the case, regardless of whether these same files were
used to load the structure in the CRYSTAL keyword.

If the file extension is not clmsum (e.g. clmup or clmdn), you can
force critic2 to use the WIEN2k interpreter by preceding the file name
with the keyword WIEN:
~~~
LOAD WIEN file.clmup
~~~
Some of these files (e.g. potentials) may have different
normalizations for the l=0 m=0 components in the muffins if they do
not represent electron densities (or spin densities). See RHONORM and
VNORM in `Additional LOAD options`_.

### Elk (STATE.OUT and other OUT files)

There are three ways of loading a scalar field generated by elk. If a
single .OUT file is passed to critic2, then it is assumed to be a grid
generated by plot3d (tasks 33, 43, 53, and 63). The loaded scalar
field will be a three-dimensional grid of values (i.e. the same as a
cube file).

If two OUT files are passed to critic2, then it is assumed that the
first is the STATE.OUT and the second is the GEOMETRY.OUT for the
current elk calculation. As in the WIEN2k case, elk's STATE.OUT is
missing the structural information required to calculate the electron
density, which is why the GEOMETRY.OUT is necessary.

Elk's STATE.OUT is version-dependent. The following versions of elk
have been tested and work with critic2: 4.0.15, 2.3.22, 2.3.16,
2.2.10, 2.2.9, 2.2.8, 2.2.5, 2.2.1, 2.1.25, 2.1.22, 1.4.22, 1.4.18,
1.4.5, 1.3.31, 1.3.30, 1.3.24, 1.3.22, 1.3.20, 1.3.15, 1.3.2, 1.2.20,
1.2.15, 1.1.4, 1.0.17, 1.0.16, and 1.0.0. If your version is not
supported (most likely because it is newer; I tend to check this part
of the code every aeon or so), please contact me.

Using a patched version of elk it is possible to generate other files
(OTHER.OUT) containing the spherical harmonics/plane waves
representation of other fields, such as the elf and the Coulomb
potential. See the tools/elk_mod directory for the patch source
files. When the OTHER.OUT (e.g. ELF.OUT) file is passed as the third
argument to the LOAD command, then that field is loaded instead of the
density.

### aiPI ion files (ion)

For aiPI inputs, several ion files are necessary. The ion files can be
associated to atoms either by using their non-equivalent atom number
(nat1.i) or the same atomic name as used in the crystal structure
specification (at1.s). 

### DFTB+ files (xml file and others)

To load a field from the calcualted wavefunction using DFTB+, three
files are required: the detailed.xml file (written by the
WriteDetailedXML option), the eigenvec.bin file (using the
WriteEigenVectors options), and the file containing the wavefunction
coefficients, which has been provided by the authors of the DFTB+
package and can be obtained online:

  <http://www.dftb-plus.info/tools/waveplot>

The DFTB type is detected by the xml extension of the first file and,
therefore, the name of these files need not be "detailed.xml" or
"eigenvec.bin". 

Two different types of systems can be run in DFTB+: crystals under
periodic boundary conditions, and molecules in the gas-phase. In the
first case, if using k-points other than Gamma, the wavefunction is
complex, and the evaluation of the density is relatively slow,
comparable to aiPI. Molecules use real wavefunctions and they tend to
be less crowded than crystals, so using molecular DFTB fields should
be considerably faster. 

### Gaussian wavefunction files (wfn/wfx)

Gaussian wavefunction files can be loaded by passing the wfn or wfx
file to critic2. This option is normally used in combination with
MOLECULE on the same file in order to obtain the same structure from
the isolated molcule. The evaluation of wfn/wfx densities and their
derivatives is analytical (no grids involved). If your file does not
have the wfn/wfx extension, you can force this format preceding the
file name with the WFN/WFX keyword.

A numerical field modifier can be used with molecular wavefunction
fields to select a particular molecular orbital. Thus, if a wfn/wfx
file is loaded in field 1, then "$1:4" selects the value of molecular
orbital number 4. Other labels such as HOMO and LUMO are also
available. See `Arithmetic expressions, variables, and functions in
critic2`_ for other field modifiers.

Supported wavefunction types: restricted (RHF), unrestricted (UHF),
and fractional occupation (MP2, etc.). Note that Gaussian wfn and wfx
files do not contain information about the virtual orbitals.

For molecular calculations that use effective core potentials (ECPs),
Gaussian provides the core density as a sum over atom-centered
Gaussian functions ("electron density functions"). These functions are
only present in a usable form in a wfx file, but not in the wfn
format. Hence, densities for molecules containing ECPs will be correct
and contain the core contribution only if the wavefunction is provided
to critic2 using the wfx format. If a wfx file is not available, core
augmentation using critic2's internal density tables is an option.

### Gaussian formatted checkpoint files (fchk)

Similar to wfn/wfx, these files contain the molecular wavefunction
information. They should be used preferably in combination with
MOLECULE. The calculation of the density and related properties is
analytical. Numerical field modifiers can be used to select particular
molecular orbitals, same as in the wfn/wfx case. If your file does not
have the fchk extension, you can force this format preceding the file
name with the FCHK keyword.

Supported wavefunction types: restricted (RHF) and unrestricted
(UHF). 

Some parts of critic2 (the MOLCALC keyword and the orbital selector
option in arithmetic expressions) may use virtual orbitals if
available. By default critic2 will not read orbitals with zero
occupation. The virtual orbitals can be read by passing the
READVIRTUAL keyword to LOAD. This keyword only makes sense in formats
that contain virtual orbital information (fchk and molden).

### Molecular molden-style files (molden)

Similar to wfn/wfx, these files contain the molecular wavefunction
information. They should be used preferably in combination with
MOLECULE. The calculation of the density and related properties is
analytical. Numerical field modifiers can be used to select particular
molecular orbitals. If your file does not have the molden extension,
you can force this format preceding the file name with the MOLDEN
keyword.

Molden files generated by different programs use slightly different
(and incompatible) versions of the same format, particularly regarding
normalization of the primitives. Recent versions of psi4 (~2016) have
been tested. ADF wavefunctions in terms of STO basis functions are
also supported (tested in 2017). If you try molden files from any
other program, please let me know how it went.

Supported wavefunction types: restricted (RHF) and unrestricted (UHF),
both with STO and GTO primitives. Virtual orbitals can be read using
the READVIRTUAL keyword.

Some parts of critic2 (the MOLCALC keyword and the orbital selector
option in arithmetic expressions) may use virtual orbitals if
available. By default critic2 will not read orbitals with zero
occupation. The virtual orbitals can be read by passing the
READVIRTUAL keyword to LOAD. This keyword only makes sense in formats
that contain virtual orbital information (fchk and molden).

### Making copies of a field

The LOAD COPY keyword can be used to make a copy of the field id.s to
the next available slot, or to id2.s if it is given with the keyword
TO.

### Loading the promolecular density

The keyword PROMOLECULAR is used to load a promolecular density field
(same as the one in slot 0). If a finite fragment of the crystal is
passed to LOAD PROMOLECULAR as an xyz file (file.xyz) using the
optional FRAGMENT keyword, then the sum of atomic densities is built
using only the atoms in that fragment.

## Additional LOAD options {#c2-addload}

The definition of a field can be supplemented by additional optional
keywords that depend on the type of field in the input and that come
after the file name. They are:
~~~
NEAREST|TRILINEAR|TRISPLINE|TRICUBIC
~~~
Choose the grid interpolation mode in a grid field. NEAREST, use the
field at the nearest grid point (zero first and second
derivatives). TRILINEAR, trilinear interpolation (zero second
derivatives). TRISPLINE, 3d-spline interpolation (adapted from the
abinit code, this part was coded by A. Lherbier according to the
source). If some derivatives are not available (first and second in
NEAREST, second in TRISPLINE), they are taken as zero. TRICUBIC,
tricubic interpolation using local information, see Lekien and
Marsden, Int. J. Numer. Meth. Engng, 63 (2005) 455-471. 

By default, TRICUBIC is used. TRISPLINE may require a lot of memory in
very large cube files (say, 400^3). However, the memory allocation for
the TRISPLINE interpolation only happens if the parts of critic2 that
require derivatives or interpolation at points outside of the grid are
called. If only grid-based algorithms (e.g. YT, BADER, NCIPLOT with
default NSTEP,...) then no additional memory is used.

Applies to: grids. Default: TRICUBIC.
~~~
CORE|NOCORE
~~~
The electron density from a pseudopotential/plane-waves calculation,
given on a grid, only represents valence electrons. In order to get an
approximation to the all-electron density, it can be augmented by
summing the corresponding core contributions to the electron density
at the atomic sites. The ZPSP values are used to determine how many
electrons are added by each core. The CORE keyword activates this
behavior (i.e., critic2 will use only the valence density from the
external grid file).

Applies to: grids (it can be activated for any other field using CORE,
but that would not make much sense). Default: NOCORE. Note that for
most grid fields read with LOAD, the pseudopotential charges (ZPSP)
are not set, so even if CORE is active, critic2 does not know how many
core electrons to add. ZPSP values are also required for core
augmentation.
~~~
EXACT|APPROXIMATE
~~~
The calculation of the electron density in aiPI and DFTB+ fields is
relatively expensive. Using the APPROXIMATE keyword, the atomic
contributions to the density are calculated by interpolating from a
radial grid, that is precomputed at the beginning of the run. EXACT
calculates the fully analytical values of the field with no
approximations.

Applies to: PI and DFTB+ fields. Default: APPROXIMATE.
~~~
RHONORM|VNORM
~~~
In WIEN2k, the clmsum and other files representing the electron
density have different normalization. The l=0 m=0 radial component is
divided by sqrt(4*pi). The option VNORM can be used if the file in the
input does not present this normalization (e.g. a potential file).

Applies to: WIEN2k. Default: RHONORM.
~~~
NOTESTMT
~~~
FPLAPW (WIEN2k and elk) scalar fields are checked by default for
discontinuities on the muffin tin surface, which can affect (or even
preclude) the location of critical points and the tracing of gradient
paths. This test may take some time if the number of atoms in the
system is large. NOTESTMT skips the discontinuity test.
~~~
NUMERICAL
~~~
Calculate the derivatives of the field numerically. Mostly used for
testing the implementation of new field types.

Applies to: all. Default: no.
~~~
ANALYTICAL
~~~
Calculate the derivatives of the field analytically. Opposite of
NUMERICAL.

Applies to: all. Default: yes.
~~~
TYPNUC {-3,3}
~~~
Controls whether the nuclei are maxima (-3) or minima (3) of the
field.

Applies to: all. Default: -3 (maxima).
~~~
NORMALIZE n.r
~~~
Normalize the grid integral over the unit cell to n.r.

Applies to: grids.
~~~
{NAME|ID} id.s
~~~
Name the field using a string identifier. The identifier can be used
in place of the field number in any expression, including arithmetic
expressions. The label for this field will be echoed in the part of
the output corresponding to this field. The string should be a single
word containing letters and numbers. You can list all available field
identifiers using the LIST keyword, see `Arithmetic expressions,
variables, and functions in critic2`_.
~~~
ZPSP at1.s q1.r...
~~~
Set the pseudopotential charges for this field. Note that setting
these charges does not activate core augmentation (use CORE as
well). See `Atomic charge options` for more details.

## Field arithmetics

New fields can be defined as combinations of the existing ones using
the LOAD AS keyword. This allows the creation of fields that are not
directly computed by the electronic structure program, and is very
useful in combination with the cube-writing keywords (keyword CUBE in
`Simple graphical representations: points, lines, planes,
grids`_). For instance, if rhoup.cube and rhodn.cube are the spin-up
and spin-down densities, it is possible to get the total density and
the spin density using:
~~~
LOAD rhoup.cube
LOAD rhodn.cube
LOAD AS "$1+$2"
LOAD AS "$1-$2"
~~~
The spin-up density is loaded as field 1, rhodn.cube is field 2, field
3 is defined as the sum of both and field 4 is the spin density, which
can, for instance, be graphically represented or integrated in the
atomic basins to get the atomic magnetic moments (see INTEGRABLE in
`Integration of atomic basins`_).

The list of arithmetic operations that can be performed on fields is
quite large (see `Arithmetic expressions, variables, and functions in
critic2`_). If no additional keywords are present between LOAD AS and
the arithmetic expression (like LAP, GRAD, or CLM, see below), then
two types of fields can be loaded. If the arithmetic expression
involves at least one grid, the resulting field will be a grid with
the same number of points. If more than one grid appears in the
expression, then the new grid size is the maximum of the number of
points in every dimension. 

If the expression contains no grid fields, then the resulting field is
what critic2 calls a "ghost field". A ghost field is just an
arithmetic expression that is parsed and processed every time the
field is evaluated. The analyitcal derivatives for a ghost field are,
naturally, not available, so the NUMERICAL option is the default for
this kind of field (see `Additional LOAD options`_).

Regardless of the types of fields in the expression passed to LOAD AS,
a grid field can be enforced by explicitly specifying the size of the
grid, either by giving the number of points in each direction (n1.i
n2.i n3.i) or by adopting the size of another grid (SIZEOF, the mold
grid is field id.s). If grid fields appear in the expression but you
want a ghost field, then use the GHOST keyword.

The PROMOLECULAR option to LOAD AS allows the creation of a grid out
of the promolecular density, with number of points n1.i, n2.i, n3.i or
the size of grid field id.s if the SIZEOF keyword is used. Similarly,
CORE creates a grid using only the core densities, as specified by the
ZPSPs of the atoms. If a fragment of the crystal is passed as an xyz
file to any of those keywords (with the optional FRAGMENT keyword),
then only the atoms in the fragment contribute to the sum of atomic
(or core) densities. 

The LAP, GRAD, POT, and CLM keywords of LOAD AS apply only to specific
types of fields:

* GRAD and POT only apply to grid fields. GRAD defines a new grid as
  the norm of the gradient of the grid field id.s. POT is the
  electrostatic (Hartree) potential generated by the density in field
  id.s. Both are calculated using a Fourier transforms to transform to
  and from reciprocal space. In the case of POT, the resulting
  potential is in Hartree by default (i.e. with a 4*pi pre-factor in
  Poisson's equation). The units can be changed to Rydberg (8*pi
  factor) by using the RY or RYDBERG keyword.

* LAP applies to grid, WIEN2K, and elk fields. In all cases, the
  keyword creates a field of the same type containing the Laplacian of
  the field id.s. If id.s is a grid, the Laplacian is calculated by
  Fourier transform. If it is a WIEN2k or elk field, the Laplacian is
  calculated analytically both inside the muffin tins and in the
  interstitial using the appropriate transformation.

* CLM defines a new field as the addition (id1+id2) or substraction
  (id1-id2) of fields of the WIEN2K or elk type by using the ADD and
  SUB keywords respectively. Note that the muffin tin radii, number of
  plane-waves, etc. have to be the same for both source fields.

## Changing the field options after LOAD (SETFIELD) {#c2-setfield}

The options of a given field can be changed anywhere in the input
after it has been loaded using the SETFIELD keyword:
~~~
SETFIELD {id.s} [NEAREST|TRILINEAR|TRISPLINE|TRICUBIC] 
   [EXACT|APPROXIMATE] [RHONORM|VNORM] [CORE|NOCORE] 
   [NUMERICAL|ANALYTICAL] [TYPNUC {-3,-1,1,3}] 
   [NORMALIZE n.r] [ZPSP at1.s q1.r...]
~~~
SETFIELD changes the properties of field with identifier id.s. The
keywords have the same meaning as in the previous sections.

## Unloading a field (UNLOAD) {#c2-unload}

~~~
UNLOAD {id.s|ALL}
~~~
Unload the field id.s or all fields (keyword ALL).

## The reference field (REFERENCE) {#c2-reference}

One of the loaded fields is chosen as the reference field. The
reference field is used as the primary field in all computations. For
instance, when BASINPLOT is used, the basins of the reference field
are plotted. If one uses an integration method (INTEGRALS, QTREE, YT,
BADER), the reference field provides the attraction basins in which
other scalar fields are integrated. If AUTO is used, the critical
points of the reference field are found. And so on.

The first field loaded becomes the reference field. If no fields have
been loaded, then the reference is the promolecular density (field "0"
or "rho0"). In order to change the reference field, the REFERENCE
keyword can be used:
~~~
REFERENCE id.s
~~~
Sets field id.s as reference. The output of this keyword is shown in
section `Typical output for the REFERENCE keyword`_.

## Typical output for the LOAD keyword

The output when loading a field is composed of two parts: a first
block containing information particular to the type of field loaded,
and a second block containing the field flags.

For instance, loading a cube file (or, actually, any grid) gives an
output whose first block looks like this:
~~~
* LOAD scalar field in slot number: 1
* GRID input, from a CUBE file
  In file: rho.cube
  Grid dimensions : 30  30  81
  First elements... 5.8881e-03 6.1552e-03 6.9787e-03
  Last elements... 8.4025e-03 6.9512e-03 6.1350e-03
  Sum of elements... 4.941377690900E+03
  Sum of squares of elements... 7.857493686793E+02
  GRID input successful 
~~~
The output for the other grid file formats (abinit DEN, VASP, qub,
xcrysden's xsf, grid, SIESTA) is essentially the same.  This output
gives the slot number for the loaded field, the type of file format
and the name of the external file containing the field, and the grid
dimension. Next, critic2 gives the first three and last three elements
in the grid (this is mostly for debug purposes).

The last two entries ("Sum of elements" and "Sum of squares of
elements") give the sum of the field and the square of the field over
all the grid nodes. The "Sum of elements" is particularly important
because, in a crystal, it is related to the integral of the field over
the entire unit cell. This integral is given by the "Sum of elements"
times the volume (in bohr^3) divided by the number of grid nodes. 
The example above, for instance, corresponds to a graphite crystal,
with a volume of 236.04767 bohr^3 and 30x30x81 = 72900 grid
points. This gives an integral over the cell of almost exactly 16
electrons. 

The second block for a grid field looks like this:
~~~
+ Flags for field number: 1
  Name: <field_1>
  From: rho.cube
  Type: grid
  Grid dimensions: 30  30  81
  Interpolation mode (1=nearest,2=linear,3=spline,4=tricubic): 3
  Cell integral (grid SUM) (1) = 16.00000922
  Min: 3.40540000E-03
  Average: 6.77829587E-02
  Max: 3.25190000E-01
  Use core densities? T
  Numerical derivatives? F
  Nuclear CP signature: -3
~~~
This block gives the name of the field (used as identifier in the rest
of the output), the source file, the type of field (grid in this
case). Since this is a grid field, the grid dimensions are repeated,
and the type of interpolation used to calculate the field values at
arbitrary points is given. Then, several computed values are given:
the integral of the field over the entire unit cell (related to the
"Sum of elements" above), and the minimum, average, and maximum field
values. This field uses core augmentation (although it is only
actually used if ZPSP are given in the input as well), the calculated
derivatives of the field are analytical, and critical points at the
nuclei are maxima (signature -3).

For WIEN2k and elk fields, the output is similar to:
~~~
* LOAD scalar field in slot number: 1
* WIEN2k input, from a CLMSUM file
  In file: bp.clmsum
  Struct file: bp.struct
  Complex?: T
  Spherical harmonics expansion LMmax: 6
  Max. points in radial grid: 781
  PW cutoff: 1.00000E-30
  Total number of plane waves: 278
  Removed trailing plane-waves: 1912
  New/original number of plane-wave set : 2733/4645

+ Flags for field number: 1
  Name: <field_1>
  From: bp.clmsum
  Type: wien2k
  Density-style normalization? T
  Use core densities? F
  Numerical derivatives? F
  Nuclear CP signature: -3

* Muffin-tin discontinuity test
  Atom: 1 RMS/max/min(fout-fin) = 0.000393 0.000757 -0.000874
  Atom: 2 RMS/max/min(fout-fin) = 0.000972 0.002234 -0.002216
+ Assert - no spurious CPs on the muffin tin surface: T
~~~
The first block gives the source field and structure files, whether
the field contains complex coefficients in the expansions (it does if
the crystal structure is not centrosymmetric), the maximum L for the
spherical harmonics expansion inside the muffins, the number of radial
points inside the muffins, the cutoff for discarding negligible
plane-wave contributions in the interstitial, and the number of
plane-waves remaining after pruning.

The second block gives the normalization of the l=0 m=0 component in
the muffins (see RHONORM and VNORM in `Additional LOAD options`_). 

WIEN2k and elk fields are particular in that they are discontinuous
when the atomic spherical harmonics expansion matches the interstitial
plane-wave expansion on the muffin tin surface. Experience has shown
that, as long as no spurious critical points are generated by this
mismatch, the field will pose no problems to the critical point search
and the gradient path tracing. For small crystals, this is usually the
case, but large molecular crystals may be more tricky. The last block
in the output above shows an automated check for spurious critical
points on the muffin surfaces. In this example, no CPs were found
(last "Assert"). The muffin tin discontiuity test can be
computationally expensive (minutes) if the system contains many
non-equivalent atoms. The NOTESTMT keyword allows skipping the test.

The output for molecular wavefunctions is comparatively simpler:
~~~
* LOAD scalar field in slot number: 1
+ Flags for field number: 1
  Name: <field_1>
  From: benzene.wfn
  Type: molecular wavefunction
  Use core densities? F
  Numerical derivatives? F
  Nuclear CP signature: -3
~~~
It contains only the type of field, the source file, and the three
relevant flags (no core augmentation, analytical derivatives, nuclei
are maxima).

If the LOAD keyword is the first in the run, the field becomes
reference, so the output for the REFERENCE keyword follows. See
`Typical output for the REFERENCE keyword`_.

## Typical output for the REFERENCE keyword

The output of the REFERENCE keyword is simple. First, the field set as
reference is given:
~~~
* Field number 2 is now REFERENCE.
~~~ 
and then the list of the integrable properties. These are the
quantities that will be integrated by the basin integration
methods. Chaning the reference field resets the integrable properties
list to its default value. Namely, the default is to integrate the
basin volumes, the reference field, and the Laplacian of the reference
field. If the reference field is an electron density, then the last
two correspond to the atomic electron population (i.e. the atomic
charges) and the electron density Laplacian. An example of this output
is:
~~~
* List of integrable properties
#  Id  Type  Field  Name
    1   v        0  Volume
    2  fval      2  Charge
    3  lval      2  Lap
~~~
See the `List of properties integrated in the attractor basins
(INTEGRABLE)`_ section for more information on integrable properties
list.

