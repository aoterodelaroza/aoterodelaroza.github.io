---
layout: single
title: "Reading a molecular structure"
permalink: /critic2/manual/molecule/
excerpt: "Reading a molecular structure in critic2."
sidebar:
  nav: "critic2_manual"
categories: critic2 manual molecule
toc: true
toc_label: "Reading a molecular structure"
toc_sticky: true
---

## Loading a molecular structure (MOLECULE) {#c2-molecule}

~~~
MOLECULE file.xyz [border.r] [CUBIC|CUBE]
MOLECULE file.wfn [border.r] [CUBIC|CUBE]
MOLECULE file.wfx [border.r] [CUBIC|CUBE]
MOLECULE file.fchk [border.r] [CUBIC|CUBE]
MOLECULE file.molden [border.r] [CUBIC|CUBE]
MOLECULE file.log [border.r] [CUBIC|CUBE]
MOLECULE file.gen [border.r] [CUBIC|CUBE]
MOLECULE file.cube
MOLECULE file.bincube
MOLECULE file.cif
MOLECULE ...
MOLECULE
  NEQ x.r y.r z.r atom.s [ANG/ANGSTROM] [BOHR/AU]
  atom.s x.r y.r z.r [ANG/ANGSTROM] [BOHR/AU]
  atnumber.i x.r y.r z.r [ANG/ANGSTROM] [BOHR/AU]
  CUBIC|CUBE
  BORDER border.r
ENDMOLECULE/END
MOLECULE LIBRARY label.s
~~~

Critic2 can be used for gas-phase (isolated) molecules as well as
crystals. A molecular structure is loaded using the MOLECULE
keyword. The MOLECULE keyword is most often used for loading an xyz or
a similar molecular format, but the molecular geometry can also be given
directly in the input using the MOLECULE/ENDMOLECULE environment or
using any of the formats typically employed for crystals (cube, cif,
scf.in). All file formats valid in a CRYSTAL keyword (see `Loading a
crystal structure (CRYSTAL)`_) are also allowed in MOLECULE. As in the
CRYSTAL case, the file extension is used to interpret the file
format.

Because critic2 works under periodic boundary conditions, it does the
analysis of molecular structures by placing the molecule at the center
of a supercell large enough to encompass it. Provided the size of the
vacuum is large enough, the analysis should be carried out without
problems. The use of MOLECULE instead of CRYSTAL changes some of the
default behavior in critic2. Namely:

* The default distance units in input and output are angstrom instead
  of bohr (use the UNITS keyword in `Input and output units`_ to
  change this behavior). In particular, this applies to the Cartesian
  coordinates for the atoms in the MOLECULE environment and to the
  argument for BORDER. In the case of xyz, wfn, wfx, fchk, molden,
  gen, and cube files, the Cartesian coordinate system in input and
  output is the same as in the original file. Only the input
  orientation is read from Gaussian log (output) files,

* The use of spglib is automatically deactivated. All molecular
  structures are run in the P1 space group (or, rather, the C1
  molecular group).

* The default critical point search seeding strategy is modified (see
  `Finding critical points`_). In a crystal, a recursive subdivision
  of a symmetry-reduced portion of the Wigner-Seitz cell is used (SEED
  WS with DEPTH 1). In a molecule, the default is to seed at the
  center of every interatomic line between atom pairs less than 15
  bohr apart (SEED PAIR).

* In addition to the supercell, a second smaller cell is defined, the
  "molecular cell", that can be represented using the MOLCELL keyword
  in WRITE (`Exporting the structure (WRITE)`_) or CPREPORT
  (`Finding critical points`_). The region outside the molecular cell
  is assumed to be vacuum outside molecular space. Any CPs found
  outside the molecular cell are discarded, and all downwards gradient
  paths that exit the molecular cell are assumed to have diverged to
  infinity. See `Input and output for a simple molecular structure`_
  and `The molecular cell`_ for a more detailed explanation.

A simple example of MOLECULE input and the corresponding output
generated by critic2 is given in `Input and output for a simple
molecular structure`_.

Multiple molecular and crystal structures can be read in
succession. See `Loading multiple crystal structures`_. 

### Molecular file formats (xyz, wfn, wfx, fchk, molden, log)

A gas-phase molecule can be input using an xyz file, a Gaussian
wfn/wfx file, a Gaussian output (log), a Gaussian formatted checkpoint
file (fchk), or a file in molden format (psi4, ADF, etc.). The
input molecule is enclosed in a parallelepiped that is larger
(default: 10 angstrom) in all directions than the minimal
parallelepiped encompassing the molecule. If the CUBIC (or CUBE)
keyword is given, then a cubic supercell is used. The width of the
vacumm around the molecule can be changed with the optional border.r
argument (by default in angstrom, the units can be changed with the
UNITS keyword). The molecule is automatically translated to the center
of the supercell.  The transformation from fractional coordinates
referred to the encompassing cell to Cartesian coordinates is made so
that the latter correspond to the original coordinate system in the
input file.  A molecular cell (that represents infinity in a gas-phase
system, see `Input and output for a simple molecular structure`_) is
chosen following the default procedure, see `The molecular cell`_.

### DFTB+ gen format (gen)

A molecule can be read in DFTB+'s gen file format. If no lattice
vectors are provided, the optional border.r and CUBIC (or CUBE)
keyword can be used to control the size and shape of the encompassing
cell. The same considerations as for xyz files apply.  The coordinates
in critic2's input and output are the same as in the gen file.

### Cube files (cube, bincube)

Cube files are also often used to describe molecular structures. For
instance, the cube files generated by Gaussian's cubegen program. As
in the case of xyz files, the Cartesian coordinate system in the rest
of the input and in the output is chosen so that it is the same as in
the cube file. A molecular cell is chosen by default (see `The
molecular cell`_).

Note that, contrary to xyz files, critic2 does not choose the size and
shape of the encompassing cell; the cell is given by the cube
file. Hence, the molecule is not translated by critic2, and it should
be centered for MOLECULE to work correctly.

Critic2 can be used to convert cube files to binary format in order to
save disk space and reading/writing time. Binary cube files have
extension .bincube, and contain essentially the same information as a
usual cube file.

### Other crystallographic formats (cif, scf.in,...)

All CRYSTAL keywords can be replaced by MOLECULE and viceversa, with
the effect discussed above. The behavior of MOLECULE in this case is
essentially the same as in the case of a cube file: the encompassing
cell is taken from the file, and the molecule is not translated in any
way.

### Manual specification of the molecular structure (MOLECULE environment)

A molecule can be specified directly in the input using the MOLECULE
environment. The atoms can be given in three different ways:
~~~
NEQ x.r y.r z.r atom.s [ANG/ANGSTROM] [BOHR/AU]
atom.s x.r y.r z.r [ANG/ANGSTROM] [BOHR/AU]
atnumber.i x.r y.r z.r [ANG/ANGSTROM] [BOHR/AU]
~~~
Each of these lines adds one atom to the molecule: the atom can be
given either with the NEQ keyword followed by the position and the
atomic symbol, or by putting the atomic symbol or the atomic number in
the first field. The position (x.r, y.r, z.r) must be given in
Cartesian coordinates. The units default to angstrom, but can be
changed using the ANG/ANGSTROM and BOHR/AU keywords, and also with the
global UNITS keyword (`Input and output units`_). 

The keywords CUBIC (or CUBE) and BORDER set the size and shape of the
encompassing supercell. This cell is taken as the minimal encompassing
cell plus a default border of 10 angstrom. This value can be changed
with the BORDER keyword (units: angstrom by default, unless changed by
the global UNITS keyword). The default cell is an orthogonal
parallelepiped: the three axes have different lengths. To make the
cell cubic, use the CUBE/CUBIC keyword.

### The molecular library (MOLECULE LIBRARY)

A library of molecular structures is provided with critic2, and can be
accessed using the MOLECULE LIBRARY keyword:
~~~
MOLECULE LIBRARY h2o
~~~
The molecular library file is dat/molecule.dat, in the root of the
critic2 distribution. The location of the molecular library can be
changed using:
~~~
LIBRARY MOLECULE bleh.s
~~~
The behavior of the LIBRARY keyword is the same as in the CRYSTAL
case. See `The crystal library (CRYSTAL LIBRARY)`_ for more
information. 

## The molecular cell {#c2-molcell}

In molecular calculations, it is convenient to define a region of
space, away from the molecule, that represents infinity. Critical
points in this region are discarded because the electron density (and
therefore the gradient) is zero everywhere. Gradient paths that reach
this region are terminated as if they had diverged to infinity.

In molecular systems, critic2 will reserve some space close to the
edges of the cell encompassing the molecule for this region. The
remaining (smaller) cell where the molecule is placed is called the
"molecular cell". 

When the MOLECULE keyword is used, a molecular cell is automatically
set up. By default, the molecular cell is chosen as the minimal
encompassing cell for the molecule plus 80% of the border or 2 bohr,
whichever is larger. Naturally, the molecular cell can not exceed the
actual cell. If the molecular structure is loaded from an external
file (xyz, wfn, etc.), then critic2 will set up both the encompassing
and the molecular cells correctly. If the structure source is a cube
or any other file format in which the encompassing cell is read from
the file, it is the users' responsibility to leave enough room for the
molecular cell.

The size of the molecular cell can be changed after the structure is
read using the MOLECELL keyword:
~~~
MOLCELL [border.r]
~~~
The MOLCELL keyword calculates the smallest parallelepiped
encompassing the molecular motif and then adds a border to it in order
to build the molecular cell. The default border is 10 angstrom, but
can be controlled by passing an additional numerical argument
(border.r, in the default distance units for the run, angstrom if you
used MOLECULE to read the structure). Using this keyword only makes
sense if the molecule is placed close to the center of the cell and if
there is an amount of vacuum between the molecule and the cell edges
enough to contain the molecular cell. In order to use MOLCELL, the
input structure needs to be read using the MOLECULE keyword and the
cell needs to be orthogonal.

