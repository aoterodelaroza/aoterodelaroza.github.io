---
layout: single
title: "Scanning tunneling microscopy (STM) plots"
permalink: /critic2/manual/stm/
excerpt: "Scanning tunneling microscopy (STM) plots in critic2."
sidebar:
  nav: "critic2_manual"
categories: critic2 manual stm
---

~~~
STM [CURRENT [curr.r]|HEIGHT [hei.r]] [TOP top.r]
    [{CELL|CELLS} nx.i ny.i] [NPTS n1.i n2.i]
    [LINE x0.r y0.r x1.r y1.r npts.i]
~~~
Generate an STM plot for the current system, comparable to those
obtained in actual STM experiments. The STM keyword should be applied
only to systems meeting the following requirements:

* The geoemtry is a slab, possibly with molecules adsorbed to one or
  both faces.

* The slab and the corresponding vacuum are perpendicular to one of
  the crystallographic axes (a, b, or c). The two angles related to
  the perpendicular axis must be right. For instance, a typical
  situation is one where a and b form a hexagonal cell in the plane,
  and c is perpendicular to the slab. The angles related to c (alpha
  and beta) both are 90 degrees.

* The slab has two faces: one with vacuum above and one below. Only
  the face with vacuum above it will be used.

* The STM plot calculation uses the reference field. For results
  consistent with the Tersoff-Hamann approximation, the reference
  field should be the local density of states (LDOS, in the following)
  at the Fermi level, that is, the density generated by the Kohn-Sham
  states close to Ef. This field can be obtained easily from common
  condensed-matter electronic structure programs. For instance, in QE,
  one would use plot_num 3 or 5 in pp.x.

There are two modes of operation in the STM keyword. In the default
mode (CURRENT), the plot gives the height (in angstrom) for which the
LDOS equals curr.r (a.u. units, default: 1d-3). This corresponds to
the constant-current mode in STM experiments. The other mode is
HEIGHT, in which the LDOS at a constant height over the surface is
plotted. This is the constant-height mode in STM experiments. The
hei.r option to HEIGHT is the fractional coordinate along the
perpendicular axis of the plot plane. By default, critic2 uses the
fractional coordinate corresponding to the last atom before the
vacuum.

The CURRENT plot shows the distance in angstrom with respect to a
point that also corresponds to the last atom before the vacuum. In
the case of a surface with adsorbed molecules on it, this is not very
useful; usually one wants to refer this value to the top of the slab
surface. The TOP keyword allows changing this value. top.r is the
fractional coordinate along the perpendicular axis that will be used
as reference for the CURRENT plot.

The CELL (or CELLS) keyword controls the number of unit cells plotted
in each in-plane crystallographic direction (default: 1 1). The number
of points plotted in each in-plane unit cell is given by the NPTS
keyword (n1.i and n2.i). By default, critic2 uses 51x51 points or, if
the reference field is a grid, the number of grid points in each of
those directions. If a grid is used, letting critic2 use the grid
geometry is strongly recommended because it is more time-efficient and
accurate.

On output, two files will be written. The <root>_stm.dat file contains
the 2D data for the STM signal on the selected plane. The
`<root>_stm.gnu` file is an example script that generates a plot similar
to those found in the literature.

The LINE keyword makes critic2 plot a line instead of a plane. The
line goes from (x0,y0) to (x1,y1), in fractional coordinates for the
in-plane crystallographic axes. npts.i points along the line are
calculated. The output file is `<root>_stm_line.dat`.

The current implementation of STM has benefited from the code and the
guidance kindly provided by Enrico Benassi (see THANKS).

